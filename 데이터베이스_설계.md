# [프로젝트명] - 데이터베이스 설계 문서

## 1. 개요
*   문서 목적: 본 문서는 [프로젝트명]의 데이터베이스 구조를 정의하며, 각 엔티티(테이블)의 속성, 관계, 제약 조건 등을 상세히 기술합니다.
*   대상 독자: 백엔드 개발자, 데이터베이스 관리자, 관련 이해관계자.

## 2. 엔티티-관계 다이어그램 (ERD)
*   (ERD는 시각적인 도구(예: draw.io, Lucidchart, DB Designer)를 사용하여 별도로 작성하고, 여기에 이미지 링크 또는 PDF 링크를 첨부하는 것을 권장합니다.)
*   **주요 엔티티 간의 관계:**
    *   User 1 : N Model (한 사용자는 여러 모델을 업로드할 수 있다)
    *   User 1 : N Project (한 사용자는 여러 프로젝트를 생성할 수 있다)
    *   Project N : M Model (한 프로젝트는 여러 모델을 포함할 수 있고, 한 모델은 여러 프로젝트에 포함될 수 있다)
    *   Project N : M Motion (한 프로젝트는 여러 모션을 포함할 수 있고, 한 모션은 여러 프로젝트에 포함될 수 있다)
    *   Model N : M Motion (한 모델에 여러 모션이 적용될 수 있고, 한 모션이 여러 모델에 적용될 수 있다)

## 3. 엔티티(테이블) 정의

### 3.1. User (사용자)
*   **설명:** 플랫폼 사용자 계정 정보를 저장하는 테이블.
*   **속성:**
    *   `user_id` (BIGINT, PK, AUTO_INCREMENT): 사용자 고유 식별자
    *   `email` (VARCHAR(255), UNIQUE, NOT NULL): 사용자 이메일 (로그인 ID)
    *   `password` (VARCHAR(255), NOT NULL): 해싱된 비밀번호
    *   `username` (VARCHAR(100), NOT NULL): 사용자 이름
    *   `profile_image_url` (VARCHAR(500)): 프로필 이미지 경로 (오브젝트 스토리지)
    *   `created_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP): 계정 생성 시간
    *   `updated_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP): 계정 정보 마지막 수정 시간

### 3.2. Model (3D 모델)
*   **설명:** 사용자가 업로드한 3D 모델의 메타데이터를 저장하는 테이블.
*   **속성:**
    *   `model_id` (BIGINT, PK, AUTO_INCREMENT): 모델 고유 식별자
    *   `user_id` (BIGINT, FK, NOT NULL): 모델을 업로드한 사용자 ID (User.user_id 참조)
    *   `file_path` (VARCHAR(500), NOT NULL): 실제 3D 모델 파일 경로 (오브젝트 스토리지)
    *   `name` (VARCHAR(255), NOT NULL): 모델 이름
    *   `format` (VARCHAR(50), NOT NULL): 모델 파일 형식 (예: GLB, FBX, OBJ)
    *   `size_mb` (DECIMAL(10, 2)): 모델 파일 크기 (MB)
    *   `thumbnail_path` (VARCHAR(500)): 모델 썸네일 이미지 경로 (오브젝트 스토리지)
    *   `description` (TEXT): 모델 설명
    *   `tags` (VARCHAR(255)): 모델 관련 태그 (콤마로 구분 또는 별도 태그 테이블 고려)
    *   `created_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP): 모델 업로드 시간
    *   `updated_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP): 모델 정보 마지막 수정 시간

### 3.3. Motion (모션 데이터)
*   **설명:** 모션 라이브러리에 저장된 모션 데이터의 메타데이터를 저장하는 테이블.
*   **속성:**
    *   `motion_id` (BIGINT, PK, AUTO_INCREMENT): 모션 고유 식별자
    *   `file_path` (VARCHAR(500), NOT NULL): 실제 모션 파일 경로 (오브젝트 스토리지)
    *   `name` (VARCHAR(255), NOT NULL): 모션 이름
    *   `format` (VARCHAR(50), NOT NULL): 모션 파일 형식 (예: FBX, BVH)
    *   `duration_sec` (DECIMAL(10, 2)): 모션 길이 (초)
    *   `category` (VARCHAR(100)): 모션 카테고리 (예: 걷기, 뛰기, 점프)
    *   `tags` (VARCHAR(255)): 모션 관련 태그
    *   `description` (TEXT): 모션 설명
    *   `created_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP): 모션 등록 시간
    *   `updated_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP): 모션 정보 마지막 수정 시간

### 3.4. Project (프로젝트)
*   **설명:** 사용자가 생성한 작업 프로젝트의 메타데이터를 저장하는 테이블.
*   **속성:**
    *   `project_id` (BIGINT, PK, AUTO_INCREMENT): 프로젝트 고유 식별자
    *   `user_id` (BIGINT, FK, NOT NULL): 프로젝트를 생성한 사용자 ID (User.user_id 참조)
    *   `name` (VARCHAR(255), NOT NULL): 프로젝트 이름
    *   `description` (TEXT): 프로젝트 설명
    *   `created_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP): 프로젝트 생성 시간
    *   `updated_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP): 프로젝트 정보 마지막 수정 시간

### 3.5. Applied_Motion (적용된 모션 기록)
*   **설명:** 특정 모델에 특정 모션이 적용된 기록 및 결과물 정보를 저장하는 테이블. (N:M 관계 해소 및 결과물 관리)
*   **속성:**
    *   `applied_motion_id` (BIGINT, PK, AUTO_INCREMENT): 적용된 모션 기록 고유 식별자
    *   `model_id` (BIGINT, FK, NOT NULL): 모션이 적용된 모델 ID (Model.model_id 참조)
    *   `motion_id` (BIGINT, FK, NOT NULL): 적용된 모션 ID (Motion.motion_id 참조)
    *   `user_id` (BIGINT, FK, NOT NULL): 모션 적용을 요청한 사용자 ID (User.user_id 참조)
    *   `result_file_path` (VARCHAR(500)): 모션 적용 결과물 파일 경로 (오브젝트 스토리지)
    *   `applied_parameters` (JSON): 모션 적용 시 사용된 파라미터 (예: 속도, 스케일, 편집 값 등)
    *   `status` (VARCHAR(50), NOT NULL): 적용 상태 (예: PENDING, PROCESSING, COMPLETED, FAILED)
    *   `created_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP): 모션 적용 요청 시간
    *   `updated_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP): 상태 마지막 업데이트 시간

### 3.6. Project_Applied_Motion (프로젝트-적용된 모션 연결)
*   **설명:** 프로젝트에 포함된 적용된 모션 기록을 연결하는 테이블. (Project와 Applied_Motion 간의 N:M 관계 해소)
*   **속성:**
    *   `project_id` (BIGINT, PK, FK): 프로젝트 ID (Project.project_id 참조)
    *   `applied_motion_id` (BIGINT, PK, FK): 적용된 모션 기록 ID (Applied_Motion.applied_motion_id 참조)
    *   `created_at` (DATETIME, NOT NULL, DEFAULT CURRENT_TIMESTAMP): 연결 생성 시간

## 4. 관계 정의
*   **User - Model:** 1 (User) : N (Model) - `Model.user_id`가 `User.user_id`를 참조.
*   **User - Project:** 1 (User) : N (Project) - `Project.user_id`가 `User.user_id`를 참조.
*   **Applied_Motion - Model:** N (Applied_Motion) : 1 (Model) - `Applied_Motion.model_id`가 `Model.model_id`를 참조.
*   **Applied_Motion - Motion:** N (Applied_Motion) : 1 (Motion) - `Applied_Motion.motion_id`가 `Motion.motion_id`를 참조.
*   **Applied_Motion - User:** N (Applied_Motion) : 1 (User) - `Applied_Motion.user_id`가 `User.user_id`를 참조.
*   **Project - Applied_Motion:** N (Project) : M (Applied_Motion) - `Project_Applied_Motion` 테이블을 통해 연결.

## 5. 인덱스 전략 (예시)
*   `User.email`: UNIQUE INDEX (로그인 성능 및 중복 방지)
*   `Model.user_id`: INDEX (사용자별 모델 조회 성능)
*   `Motion.name`, `Motion.tags`, `Motion.category`: INDEX (모션 검색 및 필터링 성능)
*   `Project.user_id`: INDEX (사용자별 프로젝트 조회 성능)
*   `Applied_Motion.model_id`, `Applied_Motion.motion_id`, `Applied_Motion.user_id`: INDEX (조회 성능)

## 6. 데이터 제약 조건 (예시)
*   모든 `_id` 컬럼은 `PRIMARY KEY` 및 `AUTO_INCREMENT`.
*   `email`, `username`, `name` 등 필수 필드는 `NOT NULL`.
*   `email`은 `UNIQUE`.
*   `password`는 해싱된 값으로 저장.
*   `created_at`, `updated_at`은 `DEFAULT CURRENT_TIMESTAMP` 및 `ON UPDATE CURRENT_TIMESTAMP` 설정.

## 7. 데이터 관리 방안 (간략히)
*   **백업:** 정기적인 데이터베이스 백업 및 오브젝트 스토리지 파일 백업.
*   **보안:** 민감 정보 암호화, 접근 제어, SQL Injection 방어.
*   **확장성:** 데이터 증가에 따른 샤딩(Sharding) 또는 파티셔닝(Partitioning) 고려 (향후).

## 8. 초기 데이터 구축 및 이관 (해당하는 경우)
*   (기존 시스템에서 데이터를 가져와야 하는 경우, 그 방법 및 범위 기술)
