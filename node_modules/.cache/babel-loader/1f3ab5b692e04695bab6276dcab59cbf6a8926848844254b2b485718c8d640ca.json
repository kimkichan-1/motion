{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef, useCallback } from 'react';\nimport { Pose } from '@mediapipe/pose';\nimport { Camera } from '@mediapipe/camera_utils';\nimport { drawConnectors, drawLandmarks } from '@mediapipe/drawing_utils';\nexport const POSE_CONNECTIONS = [\n// 상체 연결\n[11, 12],\n// 어깨\n[11, 13], [13, 15],\n// 왼팔\n[12, 14], [14, 16],\n// 오른팔\n[11, 23], [12, 24],\n// 몸통\n[23, 24],\n// 골반\n// 하체 연결\n[23, 25], [25, 27], [27, 29], [29, 31],\n// 왼다리\n[24, 26], [26, 28], [28, 30], [30, 32] // 오른다리\n];\nexport const usePoseDetection = () => {\n  _s();\n  const [isDetecting, setIsDetecting] = useState(false);\n  const [poses, setPoses] = useState(null);\n  const [error, setError] = useState(null);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const poseRef = useRef(null);\n  const cameraRef = useRef(null);\n  const onResults = useCallback(results => {\n    if (!canvasRef.current) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    ctx.save();\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    if (results.poseLandmarks) {\n      // 포즈 연결선 그리기\n      drawConnectors(ctx, results.poseLandmarks, POSE_CONNECTIONS, {\n        color: '#00FF00',\n        lineWidth: 4\n      });\n\n      // 관절점 그리기\n      drawLandmarks(ctx, results.poseLandmarks, {\n        color: '#FF0000',\n        lineWidth: 2,\n        radius: 6\n      });\n\n      // 3D 모델 업데이트를 위한 포즈 데이터 저장\n      setPoses(results.poseLandmarks);\n    }\n    ctx.restore();\n  }, []);\n  const startDetection = useCallback(async () => {\n    try {\n      setError(null);\n      if (!poseRef.current) {\n        // MediaPipe Pose 초기화\n        const pose = new Pose({\n          locateFile: file => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`\n        });\n        pose.setOptions({\n          modelComplexity: 1,\n          smoothLandmarks: true,\n          enableSegmentation: false,\n          smoothSegmentation: false,\n          minDetectionConfidence: 0.5,\n          minTrackingConfidence: 0.5\n        });\n        pose.onResults(onResults);\n        poseRef.current = pose;\n      }\n\n      // 카메라 초기화\n      if (videoRef.current && !cameraRef.current) {\n        const camera = new Camera(videoRef.current, {\n          onFrame: async () => {\n            if (poseRef.current) {\n              await poseRef.current.send({\n                image: videoRef.current\n              });\n            }\n          },\n          width: 640,\n          height: 480\n        });\n        await camera.start();\n        cameraRef.current = camera;\n      }\n      setIsDetecting(true);\n    } catch (err) {\n      setError(err.message);\n      console.error('Pose detection error:', err);\n    }\n  }, [onResults]);\n  const stopDetection = useCallback(() => {\n    if (cameraRef.current) {\n      cameraRef.current.stop();\n      cameraRef.current = null;\n    }\n    setIsDetecting(false);\n    setPoses(null);\n  }, []);\n  useEffect(() => {\n    return () => {\n      stopDetection();\n      if (poseRef.current) {\n        poseRef.current.close();\n      }\n    };\n  }, [stopDetection]);\n  return {\n    videoRef,\n    canvasRef,\n    poses,\n    isDetecting,\n    error,\n    startDetection,\n    stopDetection\n  };\n};\n_s(usePoseDetection, \"18F/isKXLZRiffJ/2fE/pdsemAg=\");","map":{"version":3,"names":["useState","useEffect","useRef","useCallback","Pose","Camera","drawConnectors","drawLandmarks","POSE_CONNECTIONS","usePoseDetection","_s","isDetecting","setIsDetecting","poses","setPoses","error","setError","videoRef","canvasRef","poseRef","cameraRef","onResults","results","current","canvas","ctx","getContext","save","clearRect","width","height","poseLandmarks","color","lineWidth","radius","restore","startDetection","pose","locateFile","file","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","smoothSegmentation","minDetectionConfidence","minTrackingConfidence","camera","onFrame","send","image","start","err","message","console","stopDetection","stop","close"],"sources":["C:/Users/vxbc5/Desktop/KDT/3번째 프로젝트 모션캡쳐/Sample1/src/hooks/usePoseDetection.js"],"sourcesContent":["import { useState, useEffect, useRef, useCallback } from 'react';\nimport { Pose } from '@mediapipe/pose';\nimport { Camera } from '@mediapipe/camera_utils';\nimport { drawConnectors, drawLandmarks } from '@mediapipe/drawing_utils';\n\nexport const POSE_CONNECTIONS = [\n  // 상체 연결\n  [11, 12], // 어깨\n  [11, 13], [13, 15], // 왼팔\n  [12, 14], [14, 16], // 오른팔\n  [11, 23], [12, 24], // 몸통\n  [23, 24], // 골반\n  // 하체 연결\n  [23, 25], [25, 27], [27, 29], [29, 31], // 왼다리\n  [24, 26], [26, 28], [28, 30], [30, 32], // 오른다리\n];\n\nexport const usePoseDetection = () => {\n  const [isDetecting, setIsDetecting] = useState(false);\n  const [poses, setPoses] = useState(null);\n  const [error, setError] = useState(null);\n\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const poseRef = useRef(null);\n  const cameraRef = useRef(null);\n\n  const onResults = useCallback((results) => {\n    if (!canvasRef.current) return;\n\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n\n    ctx.save();\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    if (results.poseLandmarks) {\n      // 포즈 연결선 그리기\n      drawConnectors(ctx, results.poseLandmarks, POSE_CONNECTIONS, {\n        color: '#00FF00',\n        lineWidth: 4\n      });\n\n      // 관절점 그리기\n      drawLandmarks(ctx, results.poseLandmarks, {\n        color: '#FF0000',\n        lineWidth: 2,\n        radius: 6\n      });\n\n      // 3D 모델 업데이트를 위한 포즈 데이터 저장\n      setPoses(results.poseLandmarks);\n    }\n\n    ctx.restore();\n  }, []);\n\n  const startDetection = useCallback(async () => {\n    try {\n      setError(null);\n\n      if (!poseRef.current) {\n        // MediaPipe Pose 초기화\n        const pose = new Pose({\n          locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`\n        });\n\n        pose.setOptions({\n          modelComplexity: 1,\n          smoothLandmarks: true,\n          enableSegmentation: false,\n          smoothSegmentation: false,\n          minDetectionConfidence: 0.5,\n          minTrackingConfidence: 0.5\n        });\n\n        pose.onResults(onResults);\n        poseRef.current = pose;\n      }\n\n      // 카메라 초기화\n      if (videoRef.current && !cameraRef.current) {\n        const camera = new Camera(videoRef.current, {\n          onFrame: async () => {\n            if (poseRef.current) {\n              await poseRef.current.send({ image: videoRef.current });\n            }\n          },\n          width: 640,\n          height: 480\n        });\n\n        await camera.start();\n        cameraRef.current = camera;\n      }\n\n      setIsDetecting(true);\n    } catch (err) {\n      setError(err.message);\n      console.error('Pose detection error:', err);\n    }\n  }, [onResults]);\n\n  const stopDetection = useCallback(() => {\n    if (cameraRef.current) {\n      cameraRef.current.stop();\n      cameraRef.current = null;\n    }\n    setIsDetecting(false);\n    setPoses(null);\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      stopDetection();\n      if (poseRef.current) {\n        poseRef.current.close();\n      }\n    };\n  }, [stopDetection]);\n\n  return {\n    videoRef,\n    canvasRef,\n    poses,\n    isDetecting,\n    error,\n    startDetection,\n    stopDetection\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}